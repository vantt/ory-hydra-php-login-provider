version: "3.5"

networks:
    default:
        driver: bridge
    proxy:
        external: true
        name: https-proxy

services:
    php:
        #build: http://git.anphabe.net/devops/docker-phpfpm.git
        image: 990863991647.dkr.ecr.us-west-2.amazonaws.com/devops/phpfpm:7.4.2.2
        volumes:
            - ${PROJECT_FOLDER}:/app
    nginx:
        #build: http://git.anphabe.net/devops/docker-nginx.git
        image: 990863991647.dkr.ecr.us-west-2.amazonaws.com/devops/nginx:v1.1.1
        ports:
        - 8080:8080
        depends_on:
            - php
        volumes:
            - ./nginx-vhost.conf:/etc/nginx/conf.d/localhost.conf
            - ${PROJECT_FOLDER}:/app
        networks:
            proxy: {}
            default: {}

